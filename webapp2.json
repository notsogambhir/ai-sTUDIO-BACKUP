{
  "pages/TeacherDetails.tsx": "/**\n * @file TeacherDetails.tsx\n * @description\n * This file defines the `TeacherDetails` component. It serves as a personal \"dashboard\"\n * for a specific teacher, showing an overview of the courses they are assigned to.\n * It's the page a user lands on after clicking \"View Dashboard\" on the `TeacherManagement` page.\n *\n * What it does:\n * 1.  **Gets Teacher ID**: It uses the `useParams` hook from React Router to read the\n *     `teacherId` from the URL (e.g., in `/teachers/TCH301`, it knows the ID is \"TCH301\").\n * 2.  **Finds Teacher Data**: It finds the full user object for that teacher from the main\n *     application data and displays their reporting structure (who their Program Co-ordinators are).\n * 3.  **Calculates Course Stats**: For each course assigned to the teacher, it calculates\n *     a summary of key information, such as the overall CO attainment (mocked for simplicity)\n *     and the status of assessments (Uploaded/Pending).\n * 4.  **Displays Information**: It shows a card for each assigned course with this summary data.\n * 5.  **Navigation**: It provides a \"Manage Course\" link to go to the full `CourseDetail`\n *     page for each course, and a \"Back\" button to return to the previous screen.\n */\n\nimport React, { useMemo } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { useAppContext } from '../hooks/useAppContext';\nimport { ArrowLeft } from '../components/Icons';\n\nconst TeacherDetails: React.FC = () => {\n    // `useParams` gets the `teacherId` from the URL.\n    const { teacherId } = useParams<{ teacherId: string }>();\n    // We get our app's data from the \"magic backpack\".\n    const { data } = useAppContext();\n    // `useNavigate` gives us a function to go back to the previous page.\n    const navigate = useNavigate();\n\n    // `useMemo` is a smart calculator that finds the teacher's data only when needed.\n    const teacher = useMemo(() => data.users.find(u => u.id === teacherId), [data.users, teacherId]);\n\n    /**\n     * `useMemo` again, this time to find the names of the Program Co-ordinators this teacher reports to.\n     */\n    const reportingToPCs = useMemo(() => {\n        if (!teacher?.programCoordinatorIds) return 'N/A';\n        \n        // Find the user object for each ID in the teacher's list.\n        const pcNames = teacher.programCoordinatorIds\n            .map(pcId => data.users.find(u => u.id === pcId)?.name)\n            .filter(Boolean); // This removes any names that weren't found.\n            \n        return pcNames.length > 0 ? pcNames.join(', ') : 'N/A';\n    }, [data.users, teacher]);\n\n    /**\n     * `useMemo` for a more complex calculation: finding all of the teacher's\n     * courses and summarizing their performance data.\n     */\n    const assignedCoursesData = useMemo(() => {\n        if (!teacher) return [];\n        // Find all courses where this teacher is the main assigned teacher.\n        const courses = data.courses.filter(c => c.teacherId === teacher.id);\n        \n        // For each course, create a summary object.\n        return courses.map(course => {\n            const enrolledStudentIds = new Set(data.enrollments.filter(e => e.courseId === course.id).map(e => e.studentId));\n            const totalStudents = enrolledStudentIds.size;\n            \n            // NOTE: This is a simplified, mocked calculation for the overall CO attainment.\n            // A real calculation would be much more complex, like on the report pages.\n            let studentsMeetingTargetCount = Math.floor(totalStudents * (Math.random() * (0.9 - 0.4) + 0.4));\n            const overallCoAttainment = totalStudents > 0 ? (studentsMeetingTargetCount / totalStudents) * 100 : 0;\n            \n            // Find all assessments for this course by looking at its sections.\n            const sectionIdsForCourse = new Set(data.enrollments.filter(e => e.courseId === course.id && e.sectionId).map(e => e.sectionId!));\n            const assessments = data.assessments\n                .filter(a => sectionIdsForCourse.has(a.sectionId))\n                .map(assessment => ({\n                    ...assessment,\n                    // Check if any marks have been uploaded for this assessment.\n                    hasMarks: data.marks.some(m => m.assessmentId === assessment.id)\n                }));\n\n            return {\n                ...course,\n                overallCoAttainment,\n                assessments,\n            };\n        });\n    }, [data, teacher]);\n\n    // If the teacher ID from the URL is not found, show an error.\n    if (!teacher) {\n        return <div className=\"text-center p-8 text-red-500\">Teacher not found.</div>;\n    }\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"bg-white p-6 rounded-lg shadow-md flex justify-between items-center\">\n                <div>\n                    <h1 className=\"text-3xl font-bold text-gray-800\">{teacher.name}'s Dashboard</h1>\n                    <p className=\"text-gray-500 mt-1\">Employee ID: {teacher.employeeId}</p>\n                    <p className=\"text-gray-500\">Reports to: <span className=\"font-medium\">{reportingToPCs}</span></p>\n                </div>\n                {/* The Back button. `navigate(-1)` tells the app's GPS to go back one step. */}\n                <button\n                    onClick={() => navigate(-1)}\n                    className=\"flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold transition-colors\"\n                    aria-label=\"Go back to previous page\"\n                >\n                    <ArrowLeft className=\"w-5 h-5 mr-2\" />\n                    Back\n                </button>\n            </div>\n            \n            {/* We loop through the summarized course data and display a card for each course. */}\n            {assignedCoursesData.map(course => (\n                <div key={course.id} className=\"bg-white p-6 rounded-lg shadow-md\">\n                    <div className=\"flex justify-between items-start\">\n                        <div>\n                            <h2 className=\"text-2xl font-bold text-gray-800\">{course.name} ({course.code})</h2>\n                            <p className={`font-semibold text-lg ${course.overallCoAttainment >= course.target ? 'text-green-600' : 'text-orange-500'}`}>\n                                Overall CO Attainment: {course.overallCoAttainment.toFixed(2)}%\n                            </p>\n                        </div>\n                        <Link to={`/courses/${course.id}`} className=\"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 font-semibold\">\n                            Manage Course\n                        </Link>\n                    </div>\n                    <div className=\"mt-4 border-t pt-4\">\n                        <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Assessments</h3>\n                        <div className=\"space-y-2\">\n                            {course.assessments.map(assessment => (\n                                <div key={assessment.id} className=\"flex justify-between items-center p-2 bg-gray-50 rounded-md\">\n                                    <p className=\"text-gray-800\">{assessment.name}</p>\n                                    <span className={`px-3 py-1 text-xs font-semibold rounded-full ${assessment.hasMarks ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}`}>\n                                        {assessment.hasMarks ? 'Marks Uploaded' : 'Pending'}\n                                    </span>\n                                </div>\n                            ))}\n                            {course.assessments.length === 0 && <p className=\"text-gray-500\">No assessments created for this course yet.</p>}\n                        </div>\n                    </div>\n                </div>\n            ))}\n             {assignedCoursesData.length === 0 && (\n                <div className=\"text-center p-8 bg-white rounded-lg shadow-md\">\n                    <p className=\"text-gray-500\">This teacher has not been assigned any courses yet.</p>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default TeacherDetails;",
  "components/CourseFacultyAssignment.tsx": "/**\n * @file CourseFacultyAssignment.tsx\n * @description\n * This component is the \"Faculty Assignment\" tab within the `CourseDetail` page. It's where\n * a Program Co-ordinator or Admin can assign teachers to a course.\n *\n * It features a dual-mode assignment system:\n * 1.  **Single Teacher Mode**: Assign one teacher to the entire course. This is the default.\n * 2.  **Assign by Section Mode**: Assign a different teacher to each specific class section.\n *     This overrides the single teacher assignment for those sections.\n *\n * What it does:\n * 1.  **Mode Switching**: Provides buttons to toggle between the two assignment modes. It uses a\n *     confirmation modal to warn the user if switching modes will clear existing assignments.\n * 2.  **Assignment UI**: Shows a different UI based on the selected mode:\n *     - A single dropdown for \"Single Teacher\" mode.\n *     - A list of sections, each with its own dropdown, for \"Assign by Section\" mode.\n * 3.  **Draft State**: All assignment changes are held in a temporary \"draft state\". The `SaveBar`\n *     appears when changes are made, allowing the user to save or cancel.\n * 4.  **Filters Teachers**: The list of available teachers in the dropdowns is filtered based\n *     on the current user's role (a PC sees their managed teachers, an Admin sees all teachers).\n * 5.  **Reset Functionality**: Includes a button to reset all section assignments back to the course default.\n */\n\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { Course, User } from '../types';\nimport { useAppContext } from '../hooks/useAppContext';\nimport SaveBar from './SaveBar';\nimport ConfirmationModal from './ConfirmationModal';\n\n// Defines the \"props\" or properties that this component accepts.\ninterface CourseFacultyAssignmentProps {\n  course: Course;\n}\n// Defines the possible assignment modes.\ntype AssignmentMode = 'single' | 'section';\n\nconst CourseFacultyAssignment: React.FC<CourseFacultyAssignmentProps> = ({ course }) => {\n  // We ask our \"magic backpack\" (AppContext) for the data and tools we need.\n  const { data, setData, currentUser } = useAppContext();\n  \n  // --- State Management ---\n  // Draft state for holding temporary changes to the course.\n  const [draftCourse, setDraftCourse] = useState<Course>(course);\n  const [initialCourse, setInitialCourse] = useState<Course>(course);\n  \n  // This `useEffect` resets the state whenever the user navigates to a different course.\n  useEffect(() => {\n    setDraftCourse(course);\n    setInitialCourse(course);\n  }, [course]);\n\n  // A piece of memory to remember which mode ('single' or 'section') is currently active.\n  const [assignmentMode, setAssignmentMode] = useState<AssignmentMode>(\n    course.sectionTeacherIds && Object.keys(course.sectionTeacherIds).length > 0 ? 'section' : 'single'\n  );\n\n  // State for the \"Are you sure?\" confirmation popup.\n  const [confirmation, setConfirmation] = useState<{\n        isOpen: boolean;\n        title: string;\n        message: string;\n        onConfirm: () => void;\n    } | null>(null);\n\n  /**\n   * `useMemo` is a smart calculator that figures out which teachers and sections are relevant for this view.\n   * It only recalculates when its dependencies change.\n   */\n  const { managedTeachers, courseSections } = useMemo(() => {\n    // Determine which teachers the current user is allowed to assign.\n    let teachers: User[] = [];\n    if (currentUser?.role === 'Program Co-ordinator') {\n        const myManagedTeacherIds = new Set(data.users.filter(u => u.role === 'Teacher' && u.programCoordinatorIds?.includes(currentUser.id)).map(u => u.id));\n        teachers = data.users.filter(u => myManagedTeacherIds.has(u.id));\n    } else if (currentUser?.role === 'Department' || currentUser?.role === 'Admin') {\n        // Department heads and Admins can assign any teacher that reports to PCs in their college.\n        const pcsInCollege = data.users.filter(u => u.role === 'Program Co-ordinator' && u.collegeId === currentUser.collegeId);\n        const pcIds = new Set(pcsInCollege.map(pc => pc.id));\n        teachers = data.users.filter(u => u.role === 'Teacher' && (u.programCoordinatorIds || []).some(id => pcIds.has(id)));\n    }\n\n    // Find all sections that have students enrolled in this course.\n    const enrolledSectionIds = new Set(data.enrollments\n        .filter(e => e.courseId === course.id && e.sectionId)\n        .map(e => e.sectionId)\n    );\n    const sections = data.sections.filter(s => enrolledSectionIds.has(s.id));\n    \n    return { managedTeachers: teachers, courseSections: sections };\n  }, [data, currentUser, course.id]);\n  \n  // `isDirty` checks if there are any unsaved changes.\n  const isDirty = useMemo(() => JSON.stringify(draftCourse) !== JSON.stringify(initialCourse), [draftCourse, initialCourse]);\n\n  /**\n   * This function runs when the user clicks to switch assignment modes.\n   * It uses a confirmation modal to prevent accidental data loss.\n   */\n  const handleModeChange = (mode: AssignmentMode) => {\n    if (mode === assignmentMode) return; // Do nothing if already in this mode.\n\n    if (mode === 'section') {\n      // If switching TO 'section' mode, warn the user it will clear the single-teacher assignment.\n      setConfirmation({\n        isOpen: true,\n        title: \"Confirm Assignment Mode Switch\",\n        message: \"Switching to 'Assign by Section' will clear any existing single-teacher assignment for this course. Are you sure you want to proceed?\",\n        onConfirm: () => {\n          setAssignmentMode('section');\n          setDraftCourse(prev => ({ ...prev, teacherId: null })); // Clear the single teacher ID.\n          setConfirmation(null);\n        }\n      });\n    } else { // Switching to 'single' mode\n      // If switching TO 'single' mode, warn the user it will clear all section assignments.\n      const hasSectionAssignments = draftCourse.sectionTeacherIds && Object.keys(draftCourse.sectionTeacherIds).length > 0;\n      if (hasSectionAssignments) {\n        setConfirmation({\n          isOpen: true,\n          title: \"Confirm Assignment Mode Switch\",\n          message: \"Switching to 'Single Teacher' will clear all existing section-specific teacher assignments. Are you sure you want to proceed?\",\n          onConfirm: () => {\n            setAssignmentMode('single');\n            setDraftCourse(prev => {\n              const { sectionTeacherIds, ...rest } = prev; // This removes the sectionTeacherIds property.\n              return rest as Course;\n            });\n            setConfirmation(null);\n          }\n        });\n      } else {\n        setAssignmentMode(mode); // If no assignments to clear, just switch.\n      }\n    }\n  };\n\n  /**\n   * This function runs when the \"Reset all to default\" button is clicked.\n   * It opens a confirmation modal before clearing all section-specific assignments\n   * from the draft state, effectively making all sections use the single course teacher.\n   */\n  const handleResetToDefault = () => {\n    const hasSectionAssignments = draftCourse.sectionTeacherIds && Object.keys(draftCourse.sectionTeacherIds).length > 0;\n    if (!hasSectionAssignments) {\n      alert(\"No section-specific assignments to reset.\");\n      return;\n    }\n\n    setConfirmation({\n      isOpen: true,\n      title: \"Reset Section Assignments\",\n      message: \"Are you sure you want to clear all section-specific assignments? All sections will revert to using the course default teacher (if set). This change will be staged and can be saved or canceled.\",\n      onConfirm: () => {\n        setDraftCourse(prev => {\n          // By creating a new object without the `sectionTeacherIds` key, we effectively remove it.\n          const { sectionTeacherIds, ...rest } = prev;\n          return rest as Course;\n        });\n        setConfirmation(null);\n      }\n    });\n  };\n\n\n  // Handlers for updating the draft state when dropdowns change.\n  const handleSingleTeacherChange = (teacherId: string) => {\n    setDraftCourse(prev => ({ ...prev, teacherId: teacherId || null }));\n  };\n  const handleSectionTeacherChange = (sectionId: string, teacherId: string) => {\n    setDraftCourse(prev => {\n        const newSectionTeachers = { ...(prev.sectionTeacherIds || {}) };\n        if (teacherId) {\n            newSectionTeachers[sectionId] = teacherId;\n        } else {\n            delete newSectionTeachers[sectionId];\n        }\n        return { ...prev, sectionTeacherIds: newSectionTeachers };\n    });\n  };\n\n  // Handlers for the SaveBar.\n  const handleSave = () => {\n    setData(prev => ({\n        ...prev,\n        courses: prev.courses.map(c => c.id === course.id ? draftCourse : c)\n    }));\n    setInitialCourse(draftCourse);\n    alert(\"Faculty assignments saved!\");\n  };\n  const handleCancel = () => {\n    setDraftCourse(initialCourse);\n    // Also reset the mode to match the initial state.\n    setAssignmentMode(initialCourse.sectionTeacherIds && Object.keys(initialCourse.sectionTeacherIds).length > 0 ? 'section' : 'single');\n  };\n\n  return (\n    <div className=\"space-y-6 pb-20\">\n      <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-xl font-semibold text-gray-700\">Faculty Assignment</h2>\n           <div className=\"flex items-center space-x-2 rounded-lg bg-gray-200 p-1\">\n                <button \n                    onClick={() => handleModeChange('single')}\n                    className={`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${assignmentMode === 'single' ? 'bg-white text-gray-800 shadow' : 'text-gray-600 hover:bg-gray-300'}`}\n                >\n                    Single Teacher\n                </button>\n                <button \n                    onClick={() => handleModeChange('section')}\n                    className={`px-4 py-1.5 text-sm font-medium rounded-md transition-colors ${assignmentMode === 'section' ? 'bg-white text-gray-800 shadow' : 'text-gray-600 hover:bg-gray-300'}`}\n                >\n                    Assign by Section\n                </button>\n            </div>\n      </div>\n\n      {assignmentMode === 'single' && (\n        <div className=\"p-4 border rounded-lg bg-gray-50\">\n           <label htmlFor=\"single-teacher-select\" className=\"block text-sm font-medium text-gray-700\">\n               Assign a single teacher for the entire course\n            </label>\n           <select\n                id=\"single-teacher-select\"\n                value={draftCourse.teacherId || ''}\n                onChange={(e) => handleSingleTeacherChange(e.target.value)}\n                className=\"mt-2 block w-full max-w-sm pl-3 pr-10 py-2 text-base bg-white text-gray-900 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\n            >\n                <option value=\"\">-- Unassigned --</option>\n                {managedTeachers.map(teacher => (\n                    <option key={teacher.id} value={teacher.id}>{teacher.name}</option>\n                ))}\n            </select>\n            <p className=\"mt-2 text-xs text-gray-500\">This teacher will be the default unless overridden by section-specific assignments.</p>\n        </div>\n      )}\n\n      {assignmentMode === 'section' && (\n         <div className=\"p-4 border rounded-lg bg-gray-50\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-md font-medium text-gray-700\">Assign a teacher to each section</h3>\n              {/* The button to reset all section assignments to the course default. */}\n              <button\n                onClick={handleResetToDefault}\n                className=\"text-sm text-indigo-600 hover:text-indigo-800 font-semibold\"\n                aria-label=\"Reset all section assignments to default\"\n              >\n                Reset all to default\n              </button>\n            </div>\n            <div className=\"space-y-3\">\n                {courseSections.map(section => (\n                    <div key={section.id} className=\"grid grid-cols-1 md:grid-cols-3 items-center gap-4\">\n                        <label htmlFor={`section-teacher-${section.id}`} className=\"font-semibold text-gray-800 text-sm\">\n                            Section {section.name}\n                        </label>\n                         <select\n                            id={`section-teacher-${section.id}`}\n                            value={draftCourse.sectionTeacherIds?.[section.id] || ''}\n                            onChange={(e) => handleSectionTeacherChange(section.id, e.target.value)}\n                            className=\"md:col-span-2 block w-full pl-3 pr-10 py-2 text-base bg-white text-gray-900 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\"\n                        >\n                            <option value=\"\">-- Use Course Default --</option>\n                            {managedTeachers.map(teacher => (\n                                <option key={teacher.id} value={teacher.id}>{teacher.name}</option>\n                            ))}\n                        </select>\n                    </div>\n                ))}\n                 {courseSections.length === 0 && (\n                    <p className=\"text-center text-gray-500 py-4\">No sections found for this course. Enroll students to see sections here.</p>\n                )}\n            </div>\n         </div>\n      )}\n      <SaveBar isDirty={isDirty} onSave={handleSave} onCancel={handleCancel} />\n      {confirmation && (\n        <ConfirmationModal\n            isOpen={confirmation.isOpen}\n            title={confirmation.title}\n            message={confirmation.message}\n            onConfirm={confirmation.onConfirm}\n            onClose={() => setConfirmation(null)}\n        />\n       )}\n    </div>\n  );\n};\n\nexport default CourseFacultyAssignment;",
  "pages/DepartmentStudentManagement.tsx": "/**\n * @file DepartmentStudentManagement.tsx\n * @description\n * This is a specialized management page exclusively for the \"Department\" user role. It gives\n * them a powerful interface to manage the student body within their college at a high level.\n *\n * What it does:\n * 1.  **Cascading Selection**: It provides dropdowns for the Department Head to first select a\n *     Program within their college, and then a specific Batch for that program.\n * 2.  **Section Management**:\n *     - It shows a list of all class sections (e.g., \"A\", \"B\") created for the selected batch.\n *     - It allows the Department Head to create new sections and delete existing ones.\n * 3.  **Student Assignment**:\n *     - It displays a table of all students who belong to the selected program.\n *     - For each student, it provides a dropdown to assign them to one of the created sections.\n *     - It allows changing a student's status ('Active' or 'Inactive').\n * 4.  **Bulk Upload**: It provides an Excel uploader to add a master list of new students to\n *     a program, who can then be assigned to sections.\n * 5.  **Draft State**: All changes to student assignments (changing a section or status) are\n *     held in a temporary \"draft state\". The `SaveBar` appears, requiring the user to\n *     explicitly save or cancel their changes.\n */\n\nimport React, { useState, useMemo, useEffect } from 'react';\nimport { useAppContext } from '../hooks/useAppContext';\nimport { Section, Student, StudentStatus } from '../types';\nimport ExcelUploader from '../components/ExcelUploader';\nimport { Trash2 } from '../components/Icons';\nimport SaveBar from '../components/SaveBar';\nimport ConfirmationModal from '../components/ConfirmationModal';\n\nconst DepartmentStudentManagement: React.FC = () => {\n    // We get all the data and tools from the \"magic backpack\".\n    const { currentUser, data, setData } = useAppContext();\n\n    // --- State Management for Forms and UI ---\n    // Memory for the cascading dropdowns that filter the page content.\n    const [selectedProgramId, setSelectedProgramId] = useState<string>('');\n    const [selectedBatch, setSelectedBatch] = useState<string>('');\n    // Memory for the \"Add New Section\" form field.\n    const [newSectionName, setNewSectionName] = useState('');\n\n    // Memory for the \"Are you sure?\" confirmation popup.\n    const [confirmation, setConfirmation] = useState<{\n        isOpen: boolean;\n        title: string;\n        message: string;\n        onConfirm: () => void;\n    } | null>(null);\n\n    // --- Draft State Management for Student Assignments ---\n    // `draftStudents` is the temporary copy of the student list we make changes to.\n    const [draftStudents, setDraftStudents] = useState<Student[]>([]);\n    // `initialStudents` is the saved version, used for comparison to see if there are unsaved changes.\n    const [initialStudents, setInitialStudents] = useState<Student[]>([]);\n\n    // `useMemo` is a \"smart calculator\" that filters the list of programs for the dropdown.\n    // It only shows programs that belong to the Department Head's own college.\n    const programsInCollege = useMemo(() =>\n        data.programs.filter(p => p.collegeId === currentUser?.collegeId)\n    , [data.programs, currentUser]);\n\n    // This one calculates the available batches for the selected program.\n    const batchesForProgram = useMemo(() => {\n        if (!selectedProgramId) return [];\n        return data.batches\n            .filter(b => b.programId === selectedProgramId)\n            .sort((a, b) => b.name.localeCompare(a.name)); // Show newest batches first.\n    }, [data.batches, selectedProgramId]);\n\n\n    /**\n     * This `useMemo` hook is the main data filter for the page. Based on the selected program\n     * and batch, it figures out exactly which sections and students to display.\n     */\n    const { sections, students } = useMemo(() => {\n        // If the user hasn't selected both a program and a batch, we show nothing.\n        if (!selectedProgramId || !selectedBatch) {\n            return { sections: [], students: [] };\n        }\n        const batch = data.batches.find(b => b.programId === selectedProgramId && b.name === selectedBatch);\n        if (!batch) {\n            return { sections: [], students: [] };\n        }\n\n        // Find all sections that belong to the selected batch.\n        const sectionsForBatch = data.sections.filter(s => s.batchId === batch.id);\n        const sectionIdsForBatch = new Set(sectionsForBatch.map(s => s.id));\n\n        // Find all students in the selected program.\n        const allStudentsForProgram = data.students.filter(s => s.programId === selectedProgramId);\n\n        // From those students, we only want to show the ones who are either already in one of\n        // this batch's sections, OR who are currently unassigned (`!s.sectionId`).\n        const studentsToDisplay = allStudentsForProgram.filter(s => \n            !s.sectionId || sectionIdsForBatch.has(s.sectionId)\n        );\n        \n        // Return the final filtered lists, sorted for consistency.\n        return { sections: sectionsForBatch, students: studentsToDisplay.sort((a, b) => a.id.localeCompare(b.id)) };\n    }, [selectedProgramId, selectedBatch, data.sections, data.students, data.batches]);\n    \n    // `useEffect` runs code \"on the side\". This one runs whenever the `students` list changes\n    // (e.g., when the user selects a new batch). It loads the new list of students into our\n    // temporary \"draft\" states.\n    useEffect(() => {\n        setDraftStudents(students);\n        setInitialStudents(students);\n    }, [students]);\n\n    // `isDirty` checks if there are any unsaved changes by comparing the draft and initial student lists.\n    const isDirty = useMemo(() => JSON.stringify(draftStudents) !== JSON.stringify(initialStudents), [draftStudents, initialStudents]);\n\n    // This is called by the ExcelUploader component when a file is parsed.\n    const handleStudentUpload = (uploadedStudents: { id: string; name: string }[]) => {\n        if (!selectedProgramId) return;\n\n        const existingStudentIds = new Set(data.students.map(s => String(s.id).toLowerCase()));\n        // Convert the Excel rows into proper `Student` objects, filtering out any duplicates.\n        const newStudents: Student[] = uploadedStudents\n            .filter(row => row.id && row.name && !existingStudentIds.has(String(row.id).toLowerCase()))\n            .map(row => ({\n                id: String(row.id),\n                name: String(row.name),\n                programId: selectedProgramId,\n                status: 'Active',\n                sectionId: null // New students are always unassigned initially.\n            }));\n\n        // Add the new students to our main application data.\n        setData(prev => ({\n            ...prev,\n            students: [...prev.students, ...newStudents]\n        }));\n        alert(`${newStudents.length} new students added to the master list. Please assign them to a section and batch.`);\n    };\n    \n    // This runs when the \"Add Section\" form is submitted.\n    const handleAddSection = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newSectionName.trim() || !selectedProgramId || !selectedBatch) return;\n\n        const batch = data.batches.find(b => b.programId === selectedProgramId && b.name === selectedBatch);\n        if (!batch) {\n            alert(\"Selected batch is invalid. Please refresh.\");\n            return;\n        }\n\n        // Create the new section object and add it to our main data.\n        const newSection: Section = {\n            id: `sec_${Date.now()}`,\n            name: newSectionName.trim().toUpperCase(),\n            programId: selectedProgramId,\n            batchId: batch.id,\n        };\n        setData(prev => ({...prev, sections: [...prev.sections, newSection]}));\n        setNewSectionName(''); // Clear the form field.\n    };\n\n    // This is the function that actually performs the deletion after the user confirms.\n    const performDeleteSection = (sectionId: string) => {\n        setData(prev => {\n            // Filter out the section that needs to be deleted.\n            const updatedSections = prev.sections.filter(s => s.id !== sectionId);\n            \n            // Unassign all students who were in the deleted section.\n            const updatedStudents = prev.students.map(student => \n                student.sectionId === sectionId ? { ...student, sectionId: null } : student\n            );\n            \n            // Return the new, updated state.\n            return { \n                ...prev, \n                sections: updatedSections,\n                students: updatedStudents \n            };\n        });\n        setConfirmation(null); // Close the popup.\n    };\n\n    // This runs when the trash can icon next to a section is clicked.\n    const handleDeleteSection = (sectionId: string) => {\n         if (isDirty) { alert(\"Please save or cancel your pending student assignment changes before deleting a section.\"); return; }\n        // It opens the \"Are you sure?\" popup first.\n        setConfirmation({\n            isOpen: true,\n            title: \"Confirm Section Deletion\",\n            message: \"Are you sure? All students in this section will be unassigned.\",\n            onConfirm: () => performDeleteSection(sectionId),\n        });\n    };\n    \n    // This runs whenever a user changes a student's \"Assigned Section\" or \"Status\" dropdown.\n    const handleStudentChange = (studentId: string, field: 'sectionId' | 'status', value: string | null) => {\n        // It only updates our temporary `draftStudents` copy, not the main data.\n        setDraftStudents(prev => prev.map(s => s.id === studentId ? { ...s, [field]: value } : s));\n    };\n\n    // This runs when \"Save Changes\" is clicked on the SaveBar.\n    const handleSave = () => {\n        setData(prev => {\n            // This is a smart way to update: we find all the students we were editing\n            // in our draft, and merge them back into the main list of all students.\n            const draftStudentIds = new Set(draftStudents.map(s => s.id));\n            const otherStudents = prev.students.filter(s => !draftStudentIds.has(s.id));\n            return { ...prev, students: [...otherStudents, ...draftStudents] };\n        });\n        setInitialStudents(draftStudents); // The draft is now the new \"saved\" state.\n        alert(\"Student assignments saved!\");\n    };\n    \n    // This runs when \"Cancel\" is clicked. It discards all changes.\n    const handleCancel = () => {\n        setDraftStudents(initialStudents);\n    };\n\n    return (\n        // `pb-20` adds padding at the bottom so the SaveBar doesn't cover content.\n        <div className=\"space-y-8 pb-20\">\n            <h1 className=\"text-3xl font-bold text-gray-800\">Student Management</h1>\n\n            {/* Top section with dropdowns for filtering. */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-white rounded-lg shadow-md\">\n                <div>\n                    <label htmlFor=\"program-select\" className=\"block text-sm font-medium text-gray-700\">Program</label>\n                    <select id=\"program-select\" value={selectedProgramId} onChange={e => setSelectedProgramId(e.target.value)} className=\"mt-1 block w-full pl-3 pr-10 py-2 text-base bg-white text-gray-900 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\">\n                        <option value=\"\">-- Select a Program --</option>\n                        {programsInCollege.map(p => <option key={p.id} value={p.id}>{p.name}</option>)}\n                    </select>\n                </div>\n                <div>\n                    <label htmlFor=\"batch-select\" className=\"block text-sm font-medium text-gray-700\">Batch</label>\n                    <select id=\"batch-select\" value={selectedBatch} onChange={e => setSelectedBatch(e.target.value)} className=\"mt-1 block w-full pl-3 pr-10 py-2 text-base bg-white text-gray-900 border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md\" disabled={!selectedProgramId}>\n                        <option value=\"\">-- Select a Batch --</option>\n                        {batchesForProgram.map(b => <option key={b.id} value={b.name}>{b.name}</option>)}\n                    </select>\n                </div>\n            </div>\n\n            {/* Main content area, only visible after program/batch are selected. */}\n            {selectedProgramId && selectedBatch && (\n                <>\n                    {/* Section Management */}\n                    <div className=\"bg-white p-6 rounded-lg shadow-md\">\n                        <h3 className=\"text-xl font-semibold text-gray-700 mb-4\">Manage Sections</h3>\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                            <div>\n                                <h4 className=\"font-semibold text-gray-600 mb-2\">Existing Sections</h4>\n                                <ul className=\"space-y-2\">\n                                    {sections.map(section => (\n                                        <li key={section.id} className=\"flex justify-between items-center p-2 bg-gray-100 rounded\">\n                                            <span>Section {section.name}</span>\n                                            <button onClick={() => handleDeleteSection(section.id)} className=\"text-red-500 hover:text-red-700\"><Trash2 className=\"w-4 h-4\" /></button>\n                                        </li>\n                                    ))}\n                                    {sections.length === 0 && <p className=\"text-sm text-gray-500\">No sections created yet.</p>}\n                                </ul>\n                            </div>\n                            <form onSubmit={handleAddSection} className=\"space-y-2\">\n                                <h4 className=\"font-semibold text-gray-600\">Add New Section</h4>\n                                <input type=\"text\" value={newSectionName} onChange={e => setNewSectionName(e.target.value)} placeholder=\"e.g., C\" className=\"w-full p-2 border border-gray-300 rounded-md\" required />\n                                <button type=\"submit\" className=\"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700\">Add Section</button>\n                            </form>\n                        </div>\n                    </div>\n\n                    {/* Student Assignment Table */}\n                    <div className=\"bg-white p-6 rounded-lg shadow-md\">\n                        <div className=\"flex justify-between items-center mb-4\">\n                            <h3 className=\"text-xl font-semibold text-gray-700\">Student Assignments</h3>\n                            <ExcelUploader<{ id: string; name: string }> onFileUpload={handleStudentUpload} label=\"Upload Students\" format=\"cols: id, name\" />\n                        </div>\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"min-w-full divide-y divide-gray-200\">\n                                <thead className=\"bg-gray-50\">\n                                    <tr>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Student ID</th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Student Name</th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Assigned Section</th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"bg-white divide-y divide-gray-200\">\n                                    {draftStudents.map(student => (\n                                        <tr key={student.id}>\n                                            <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{student.id}</td>\n                                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600\">{student.name}</td>\n                                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                <select\n                                                    value={student.sectionId || ''}\n                                                    onChange={(e) => handleStudentChange(student.id, 'sectionId', e.target.value || null)}\n                                                    className=\"w-full p-2 border bg-white text-gray-900 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                                                >\n                                                    <option value=\"\">-- Unassigned --</option>\n                                                    {sections.map(section => (\n                                                        <option key={section.id} value={section.id}>Section {section.name}</option>\n                                                    ))}\n                                                </select>\n                                            </td>\n                                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                <select\n                                                    value={student.status}\n                                                    onChange={(e) => handleStudentChange(student.id, 'status', e.target.value as StudentStatus)}\n                                                    className=\"w-full p-2 border bg-white text-gray-900 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                                                >\n                                                    <option value=\"Active\">Active</option>\n                                                    <option value=\"Inactive\">Inactive</option>\n                                                </select>\n                                            </td>\n                                        </tr>\n                                    ))}\n                                     {draftStudents.length === 0 && (\n                                        <tr>\n                                            <td colSpan={4} className=\"text-center py-8 text-gray-500\">\n                                                No students found for this program, or no batch selected.\n                                            </td>\n                                        </tr>\n                                    )}\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                </>\n            )}\n            \n            <SaveBar isDirty={isDirty} onSave={handleSave} onCancel={handleCancel} />\n            {confirmation && <ConfirmationModal isOpen={confirmation.isOpen} title={confirmation.title} message={confirmation.message} onConfirm={confirmation.onConfirm} onClose={() => setConfirmation(null)}/>}\n        </div>\n    );\n};\n\nexport default DepartmentStudentManagement;",
  "pages/DepartmentFacultyManagement.tsx": "/**\n * @file DepartmentFacultyManagement.tsx\n * @description\n * This is a specialized management page exclusively for the \"Department\" user role. It allows\n * them to manage the faculty hierarchy within their college.\n *\n * The page is divided into two main sections:\n *\n * 1.  **Program Co-ordinator (PC) Assignments**:\n *     - It shows a table of all programs in the Department Head's college.\n *     - For each program, it provides a dropdown to assign a single PC to manage it.\n *     - This section uses a \"draft state\" pattern. Changes are not saved immediately,\n *       and the `SaveBar` appears to allow saving or canceling all changes at once.\n *\n * 2.  **Teacher Assignments**:\n *     - It shows a table of all teachers who report to the PCs in this department.\n *     - For each teacher, it shows which PC(s) they are currently assigned to.\n *     - It provides a \"Manage\" button that opens a popup modal (`TeacherAssignmentModal`),\n *       where the Department Head can use checkboxes to assign a teacher to one or more PCs.\n *     - Changes made in this modal are saved immediately when the modal is saved.\n */\n\nimport React, { useMemo, useState, useEffect } from 'react';\nimport { useAppContext } from '../hooks/useAppContext';\nimport { User } from '../types';\nimport Modal from '../components/Modal';\nimport { Edit } from '../components/Icons';\nimport SaveBar from '../components/SaveBar';\n\n/**\n * A private component for the popup modal used to assign teachers to PCs.\n * It's defined inside this file because it's only used here.\n */\nconst TeacherAssignmentModal: React.FC<{ teacher: User; onClose: () => void; }> = ({ teacher, onClose }) => {\n    const { currentUser, data, setData } = useAppContext();\n    // A piece of memory to keep track of which checkboxes are checked.\n    const [selectedPcIds, setSelectedPcIds] = useState<string[]>(teacher.programCoordinatorIds || []);\n    \n    // Find all PCs that belong to the current Department Head.\n    const programCoordinators = useMemo(() =>\n        data.users.filter(u => u.role === 'Program Co-ordinator' && u.departmentId === currentUser?.id)\n    , [data.users, currentUser]);\n\n    // This runs when a checkbox is clicked.\n    const handleCheckboxChange = (pcId: string, isChecked: boolean) => {\n        setSelectedPcIds(prev => isChecked ? [...prev, pcId] : prev.filter(id => id !== pcId));\n    };\n\n    // This runs when the \"Save Assignments\" button in the modal is clicked.\n    const handleSave = () => {\n        // It updates the main application data immediately.\n        setData(prev => ({\n            ...prev,\n            users: prev.users.map(u => u.id === teacher.id ? {...u, programCoordinatorIds: selectedPcIds } : u)\n        }));\n        onClose(); // Close the modal.\n    };\n\n    return (\n        <Modal title={`Assign Co-ordinators for ${teacher.name}`} onClose={onClose}>\n            {/* FIX: Replaced placeholder comment with actual modal content to satisfy the 'children' prop requirement. */}\n            <>\n                <div className=\"p-6 space-y-4 max-h-[60vh] overflow-y-auto\">\n                    <p className=\"text-sm text-gray-600\">Select the Program Co-ordinators this teacher reports to.</p>\n                    {programCoordinators.map(pc => (\n                        <div key={pc.id} className=\"flex items-center\">\n                            <input\n                                type=\"checkbox\"\n                                id={`pc-assign-${pc.id}`}\n                                checked={selectedPcIds.includes(pc.id)}\n                                onChange={(e) => handleCheckboxChange(pc.id, e.target.checked)}\n                                className=\"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500\"\n                            />\n                            <label htmlFor={`pc-assign-${pc.id}`} className=\"ml-3 text-sm text-gray-700\">\n                                {pc.name}\n                            </label>\n                        </div>\n                    ))}\n                    {programCoordinators.length === 0 && <p className=\"text-gray-500\">No Program Co-ordinators found in this department.</p>}\n                </div>\n                <div className=\"bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t\">\n                    <button type=\"button\" onClick={onClose} className=\"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50\">Cancel</button>\n                    <button type=\"button\" onClick={handleSave} className=\"bg-indigo-600 text-white py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium hover:bg-indigo-700\">Save Assignments</button>\n                </div>\n            </>\n        </Modal>\n    );\n};\n\n\n// This is the main component for the Department Faculty Management page.\nconst DepartmentFacultyManagement: React.FC = () => {\n    const { currentUser, data, setData } = useAppContext();\n    // A piece of memory to remember which teacher is being edited in the modal.\n    const [editingTeacher, setEditingTeacher] = useState<User | null>(null);\n\n    // `useMemo` is a smart calculator that filters all the faculty and programs for this department.\n    const { programs, programCoordinators, teachers } = useMemo(() => {\n        if (!currentUser?.collegeId) return { programs: [], programCoordinators: [], teachers: [] };\n        \n        const collegePrograms = data.programs.filter(p => p.collegeId === currentUser.collegeId);\n        const collegePcs = data.users.filter(u => u.role === 'Program Co-ordinator' && u.departmentId === currentUser.id);\n        const pcIds = new Set(collegePcs.map(pc => pc.id));\n        const collegeTeachers = data.users.filter(u => u.role === 'Teacher' && (u.programCoordinatorIds || []).some(id => pcIds.has(id)));\n\n        return { programs: collegePrograms, programCoordinators: collegePcs, teachers: collegeTeachers };\n    }, [currentUser, data]);\n\n    // --- Draft State for PC Assignments ---\n    const [draftPcAssignments, setDraftPcAssignments] = useState<{ [programId: string]: string }>({});\n    const [initialPcAssignments, setInitialPcAssignments] = useState<{ [programId: string]: string }>({});\n\n    // This effect loads the initial PC assignments into our draft state.\n    useEffect(() => {\n        const assignments: { [programId: string]: string } = {};\n        programs.forEach(p => {\n            const assignedPC = programCoordinators.find(pc => pc.programId === p.id);\n            assignments[p.id] = assignedPC ? assignedPC.id : '';\n        });\n        setDraftPcAssignments(assignments);\n        setInitialPcAssignments(assignments);\n    }, [programs, programCoordinators]);\n\n    // `isDirty` checks if there are any unsaved PC assignment changes.\n    const isDirty = useMemo(() => JSON.stringify(draftPcAssignments) !== JSON.stringify(initialPcAssignments), [draftPcAssignments, initialPcAssignments]);\n\n    // This runs when a PC assignment dropdown is changed.\n    const handleProgramAssignmentChange = (programId: string, pcId: string) => {\n        setDraftPcAssignments(prev => ({ ...prev, [programId]: pcId }));\n    };\n\n    // This runs when \"Save Changes\" is clicked on the SaveBar.\n    const handleSave = () => {\n        setData(prev => {\n            // This is a complex update. First, it unassigns ALL PCs managed by this department head.\n            const updatedUsers = prev.users.map(user => {\n                if (user.role === 'Program Co-ordinator' && user.departmentId === currentUser?.id) {\n                    const { programId, ...rest } = user; // This removes the `programId` property.\n                    return rest as User;\n                }\n                return user;\n            }).map(user => {\n                // Then, it re-assigns them based on the `draftPcAssignments`.\n                const assignedProgramId = Object.keys(draftPcAssignments).find(\n                    progId => draftPcAssignments[progId] === user.id\n                );\n                return assignedProgramId ? { ...user, programId: assignedProgramId } : user;\n            });\n\n            return { ...prev, users: updatedUsers };\n        });\n        setInitialPcAssignments(draftPcAssignments); // Reset the dirty check.\n        alert(\"PC assignments saved successfully!\");\n    };\n\n    const handleCancel = () => {\n        setDraftPcAssignments(initialPcAssignments);\n    };\n    \n    return (\n        <div className=\"space-y-8 pb-20\">\n            <h1 className=\"text-3xl font-bold text-gray-800\">Faculty Management</h1>\n\n            {/* Section 1: Program Co-ordinator Assignments */}\n            <div className=\"bg-white p-6 rounded-lg shadow-md\">\n                <h2 className=\"text-xl font-semibold text-gray-700 mb-4\">Program Co-ordinator Assignments</h2>\n                <div className=\"overflow-x-auto\">\n                    <table className=\"min-w-full divide-y divide-gray-200\">\n                        <thead className=\"bg-gray-50\">\n                            <tr>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Program</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Assigned Co-ordinator</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\n                            {programs.map(program => (\n                                <tr key={program.id}>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{program.name}</td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                        <select\n                                            value={draftPcAssignments[program.id] || ''}\n                                            onChange={(e) => handleProgramAssignmentChange(program.id, e.target.value)}\n                                            className=\"w-full max-w-xs p-2 border bg-white text-gray-900 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                                        >\n                                            <option value=\"\">-- Unassigned --</option>\n                                            {programCoordinators.map(pc => (\n                                                <option key={pc.id} value={pc.id}>{pc.name}</option>\n                                            ))}\n                                        </select>\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n\n            {/* Section 2: Teacher Assignments */}\n            <div className=\"bg-white p-6 rounded-lg shadow-md\">\n                <h2 className=\"text-xl font-semibold text-gray-700 mb-4\">Teacher Assignments to Co-ordinators</h2>\n                <div className=\"overflow-x-auto\">\n                    <table className=\"min-w-full divide-y divide-gray-200\">\n                        <thead className=\"bg-gray-50\">\n                             <tr>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Teacher</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Assigned Co-ordinator(s)</th>\n                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">Actions</th>\n                            </tr>\n                        </thead>\n                         <tbody className=\"bg-white divide-y divide-gray-200\">\n                            {teachers.map(teacher => (\n                                <tr key={teacher.id}>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{teacher.name}</td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                        {teacher.programCoordinatorIds?.map(pcId => data.users.find(u => u.id === pcId)?.name).filter(Boolean).join(', ') || 'N/A'}\n                                    </td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                                        <button onClick={() => setEditingTeacher(teacher)} className=\"text-indigo-600 hover:text-indigo-800 flex items-center gap-1\">\n                                            <Edit className=\"w-4 h-4\" /> Manage\n                                        </button>\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n\n            {/* The modal is only rendered if `editingTeacher` is not null. */}\n            {editingTeacher && (\n                <TeacherAssignmentModal teacher={editingTeacher} onClose={() => setEditingTeacher(null)} />\n            )}\n\n            <SaveBar isDirty={isDirty} onSave={handleSave} onCancel={handleCancel} />\n        </div>\n    );\n};\n\nexport default DepartmentFacultyManagement;",
  "components/SaveBar.tsx": "/**\n * @file SaveBar.tsx\n * @description\n * This file defines the `SaveBar` component. It's the bar that appears at the bottom\n * of the screen whenever a user has made unsaved changes on a page.\n *\n * It's a very simple and \"dumb\" component. It only does two things:\n * 1.  It shows itself if its parent component tells it that there are unsaved changes\n *     (by passing `isDirty={true}`).\n * 2.  It shows \"Save\" and \"Cancel\" buttons. When these buttons are clicked, they call\n *     the `onSave` and `onCancel` functions that were given to it by its parent.\n *\n * This makes it a highly reusable \"reminder\" component for any page that has a\n * \"draft state\" or unsaved changes.\n */\n\nimport React from 'react';\n\n// This defines the \"props\" or properties that this component accepts from its parent.\ninterface SaveBarProps {\n  isDirty: boolean; // Are there unsaved changes?\n  onSave: () => void; // What to do when \"Save\" is clicked.\n  onCancel: () => void; // What to do when \"Cancel\" is clicked.\n}\n\nconst SaveBar: React.FC<SaveBarProps> = ({ isDirty, onSave, onCancel }) => {\n  // If the parent component tells us there are no unsaved changes (`isDirty` is false),\n  // then we render nothing at all. The component is invisible.\n  if (!isDirty) {\n    return null;\n  }\n\n  // If `isDirty` is true, we render the bar.\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0 bg-gray-800 bg-opacity-90 shadow-lg p-4 border-t border-gray-600 z-20 flex justify-center sm:justify-end sm:left-64 backdrop-blur-sm\">\n      <div className=\"flex items-center gap-4 sm:pr-8\">\n        <p className=\"text-white hidden lg:block\">You have unsaved changes.</p>\n        <button\n          onClick={onCancel}\n          className=\"px-6 py-2 bg-gray-500 text-white font-semibold rounded-lg hover:bg-gray-600 transition-colors\"\n        >\n          Cancel\n        </button>\n        <button\n          onClick={onSave}\n          className=\"px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors\"\n        >\n          Save Changes\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default SaveBar;"
}